<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0" xml:base="https://joshuami.com/">
  <channel>
    <title>Github</title>
    <link>https://joshuami.com/</link>
    <description/>
    <language>en</language>
    
    <item>
  <title>This Blog is on Drupal CMS (Starshot)... Kinda... for Now</title>
  <link>https://joshuami.com/blog/2024-12/blog-drupal-cms-starshot-kinda-now</link>
  <description><![CDATA[
<span>This Blog is on Drupal CMS (Starshot)... Kinda... for Now</span>

<span><span>joshuami</span></span>

<span>Wed, 18 Dec 2024 - 11:01
</span>
  
    
      


  
    
      
      


      <h3 class="field__label field--tags__label">Tags</h3>
    <ul class="links field__items field--tags__items">
          <li class="field--tags__item"><a href="https://joshuami.com/taxonomy/term/2" hreflang="en">Drupal</a></li>
          <li class="field--tags__item"><a href="https://joshuami.com/taxonomy/term/3" hreflang="en">Starshot</a></li>
          <li class="field--tags__item"><a href="https://joshuami.com/taxonomy/term/4" hreflang="en">DDev</a></li>
          <li class="field--tags__item"><a href="https://joshuami.com/taxonomy/term/5" hreflang="en">Tome</a></li>
          <li class="field--tags__item"><a href="https://joshuami.com/taxonomy/term/6" hreflang="en">Github</a></li>
      </ul>


    
  



  
    
      
      
            <p>In 2015, <a href="https://joshuami.com/2015/07/08/keeping-sharp-with-jekyll-blogging-tool" data-entity-type="node" data-entity-uuid="518cf2ec-31ed-4a72-81f1-80249e33bfe6" data-entity-substitution="canonical">I moved this site to Github Pages</a> from a Drupal 7 installation. I had several reasons for this move, but my biggest concern was security. I was—and still am—a busy professional with clients that need me to keep my attention on their sites when significant security announcements or releases land in the Drupal world. When I made the move, I was much more concerned with keeping <a href="https://www.drupal.org/">Drupal.org</a> secure and stable than a personal blog.</p>
<p>I was also keen to use markdown for editing my blog—which I've since become less enamored with due to the excellent markdown autocompletion support <a href="https://support.google.com/docs/answer/12014036?hl=en">built into tools like Google Docs</a> and even <a href="https://www.drupal.org/node/3389141">Drupal's CKEditor implementation</a>.&nbsp;</p>
<p>After years of setting up ambitious editorial experiences in modern Drupal, I wanted to be able to experience those improvements in my own blogging. Heck, maybe it will get me writing a bit more.</p>
<p>So with a little spare time this holiday season, I've decided to give a new approach a try.&nbsp;</p>
<p>This site was built using Drupal CMS (currently 1.0.0-rc2), DDev, Tome (a static site generator for Drupal), and Github Pages using a Github Action to deploy the Tome-generated artifact. Technically, the site is also delivered via Cloudflare using a free-tier account. The Cloudflare setup was a throwback to the days when Github Pages did not support HTTPS. I've kept it for the analytics the Cloudflare dashboard. With this current setup, I spend $0 on hosting—though there are a few drawbacks that I'll explain below.</p>
<h2>Getting Started with DDev</h2>
<p>A few days ago, <a href="https://www.drupal.org/u/drubb">drubb</a> posted <a href="https://drupal.slack.com/archives/C072BF486FN/p1733943130041509">instructions for trying Drupal CMS using Lando</a>. While I used <a href="https://lando.dev/">Lando</a> for quite a few years on the <a href="https://www.portland.gov/">Portland.gov</a> project, and I'm quite fond of its approach to tooling, I pretty much exclusively use <a href="https://ddev.com/">DDev</a> these days for local development. It is faster and has options for Docker management like Rancher Desktop. It's fast on Mac ARM processors and it just works—it also feels like the <a href="https://www.drupal.org/docs/getting-started/installing-drupal/install-drupal-using-ddev">community is standardizing on DDev a bit as a "recommended" local development tool</a>. So I thought, huh, I wonder if I can match that Lando example.</p>
<p>30 minutes later, because of a couple of wrong turns, I had a working copy of Drupal CMS.</p>
<p>Here are the steps assuming you already have <a href="https://ddev.readthedocs.io/en/stable/users/install/ddev-installation/">DDev installed</a>.</p>
<p>Create your project directory and open it.</p>
<pre><code class="language-shell">mkdir drupalcms &amp;&amp; cd drupalcms</code></pre><p>Configure DDev. Feel free to update your project name and webroot.</p>
<pre><code class="language-shell">ddev config --auto --project-name=drupalcms --docroot=web --project-type=drupal</code></pre><p>Use DDev to create your composer project within your project directory. Installing Composer is not required as it will use Composer in the container.</p>
<pre><code class="language-shell">ddev composer create drupal/cms --ignore-platform-reqs --stability dev</code></pre><p>Launch your site and use the site installer. You won't need to enter database credentials as DDev takes care of this for you.</p>
<pre><code class="language-shell">ddev launch</code></pre><p>Assuming you didn't change the project name, it will open the resulting site at <a href="https://drupalcms.ddev.site/">https://drupalcms.ddev.site/</a> and you'll see the new Drupal CMS installer.&nbsp;</p>
<p>It's worth noting that <a href="https://www.drupal.org/u/phenaproxima">phenaproxima</a>, who is a big part of architecting how Drupal CMS is composed, suggested that there are no guarantees that the above will continue to work through the first stable release even if that is the goal.</p>
<h2>Drupal CMS (Starshot) as a Starting Point</h2>
<p>I plan to do a more detailed write up on my thoughts regarding Starshot. I've followed it pretty closely since DrupalCon Portland when it was announced. It has a lot of promise to give a more complete Drupal experience from the point of installation. It is also very opionnated. I'm pretty opinionated as well, at least about my Drupal approaches, so I'm on the fence regarding some of the choices in Drupal CMS, but I wanted this initial release of my blog to be as close to the based installation as possible.</p>
<p>Keep in mind, all of what I'm showing below is subject to change between now and 15 January 2025 when Drupal CMS is scheduled for its first stable release. That said, with less than a month, I wouldn't expect huge changes from what I'm seeing at this point. They might remove a bit more, but I doubt a lot will get added.</p>
<p>To get started, I selected just the "blog" content type, clicked next.</p>

  
      
  
    Image
                  
                  
                  

  


          

  
<p>The next few screens will walk you through naming your site and creating the first user.</p>

  
      
  
    Image
                  
                  
                  

  


          

  
<p>Incidentally, it automatically names this first user "admin" (opinionated remember) so you may want to consider this initial account a service account rather than the account you'll regularly use to publish content on a site like a personal blog.</p>

  
      
  
    Image
                  
                  
                  

  


          

  
<p>The first thing I noticed was just how many modules Drupal CMS has in its default install—even when all I've added is the blog content type—so very opinionated at this point.</p>
<p>Now that the install is complete, your fresh new user will land on a fresh new dashboard.</p>

  
      
  
    Image
                  
                  
                  

  


          

  
<p>The combination of the Gin admin theme, the new navigation layout, and this simple dashboard is a significant change for anyone with much of a history with Drupal.</p>
<p>Clicking "Create" in the new side navigation will immediately give you a little sense of just how much is included by default in with just the blog content type enabled.</p>

  
      
  
    Image
                  
                  
                  

  


          

  
<p>The options for basic page, blog post (enabled as part of the install) as well as document, image, and user all make sense as sane defaults. That said, I was shocked at some of hte enabled modules in this initial install. In addition to core modules, the following is in this the standard profile:</p>
<ul>
<li>Autosave Form</li>
<li>ECA
<ul>
<li>BPMN.iO for ECA</li>
<li>ECA base</li>
<li>ECA BPMN</li>
<li>ECA Content</li>
<li>ECA Core</li>
<li>ECA Form</li>
<li>ECA Miscellaneous</li>
<li>ECA Render</li>
<li>ECA UI</li>
<li>ECA User</li>
</ul>
</li>
<li>Simple Add More</li>
<li>JQuery UI</li>
<li>JQuery UI Resizeable</li>
<li>Drupal Symphony Mailer Lite</li>
<li>Easy Email</li>
<li>Easy Email Overrides</li>
<li>Focal Point</li>
<li>SVG Image</li>
<li>Easy Breadcrumb</li>
<li>Automatic Updates (which will be part of core one day)</li>
<li>Automatic Updates Extensions</li>
<li>Coffee (though I hear this might be removed for performance reasons)</li>
<li>Gin Toolbar</li>
<li>Login with email or username</li>
<li>Menu Link Attributes</li>
<li>Package Manager</li>
<li>Pathauto</li>
<li>Project Browser</li>
<li>Redirect</li>
<li>Redirect 404</li>
<li>Token</li>
<li>Trash</li>
<li>Antibot</li>
<li>CAPTCHA</li>
<li>Friendly Captcha</li>
<li>Honeypot</li>
<li>Klaro Cookie &amp; Consent Manager</li>
<li>Linkit</li>
<li>Add Content by Bundle</li>
<li>Better Exposed Filters</li>
<li>Selective Better Exposed Filters</li>
</ul>
<p>Wow. Did I mention Drupal CMS will be a bit opinionated? This isn't even a complete list of what has been added to the composer dependencies for the project. There are quite a few additional modules included in that dependency tree that you'll likely find yourself using on many projects.</p>
<p>While I've used a fair number of these modules, I was surprised with quite a few that I had not hear of before Drupal CMS. When I get around to a more thorough review, I'll give my thoughts on which of these I feel like I'll be pruning from nearly every install.</p>
<p>It's also worth noting that there is so much more in Drupal CMS than just contrib modules and related recipes. For example, Drupal CMS has 53 image styles and 29 responsive image styles. Drupal CMS also enables some features by default that I have not used on every Drupal project like Layout Builder—which I've never used without installing a lot of <a href="https://www.drupal.org/docs/8/core/modules/layout-builder/additional-modules">other layout builder contrib modules</a>. This choice has huge implications for future Drupal architectural approaches.</p>
<h2>Importing Old Posts into Drupal CMS</h2>
<p>Drupal has powerful migration tools to get content into its database. If you haven't seen the <a href="https://www.youtube.com/watch?v=nhPiL4g972A">demo from DrupalCon Barcelona</a> where Dries talks about the possibilty of AI importers, I highly recommend it. That said, I wasn't keen on writing all the prompts to pull in 59 blog posts. (Did I mention I want to write more?)</p>
<p>Jekyll has a templating language, Liquid, that is quite similar to the Twig used by Drupal. I spent a little time to create a template that would generate a CSV file with my posts and used the <a href="https://www.drupal.org/project/feeds">Feeds</a> module to create an import process in a couple hours.</p>
<p>Alternatively, I could have used the migration framework and written a script to use a contrib module like <a href="https://www.drupal.org/project/migrate_source_csv">Migrate Source CSV</a>. I highly recommend the migration framework for complex migrations that need to be rerun multiple times against large content models.</p>
<h2>Configuring Tome and Github Pages</h2>
<p><a href="https://www.drupal.org/project/tome">Tome</a> is a static site generator for Drupal. The <a href="https://tome.fyi/docs/">documentation for Tome</a> is pretty solid with guides for several different hosting options.</p>
<p>Adding Tome is simple:</p>
<pre><code class="language-shell">composer require drupal/tome
drush en tome</code></pre><p>You'll need to let Drupal know where Tome should place its artifacts by adding some values to <code>settings.php</code>. The defaults in Tome's documentation look like this:</p>
<pre><code class="language-php">$settings['tome_files_directory'] = '../files';
$settings['tome_content_directory'] = '../content';
$settings['tome_static_directory'] = '../html';
$config_directories['sync'] = '../config';</code></pre><p>I chose to put my files in the same directory as the generated static content.</p>
<pre><code class="language-php">$settings['tome_files_directory'] = '../html';</code></pre><p>This allowed me to keep some images from my Jekyll installation in the same site relative location as it copied them from what was the Jekyll root into the new Tome static directory.</p>
<p>Running your first export is straightforward.</p>
<pre><code class="language-shell">drush tome:export -y</code></pre><p>Just before you commit your changes, you'll want to generate your static site with the production URI. For my site, I ran this.</p>
<pre><code class="language-shell">drush tome:static --uri=https://joshuami.com</code></pre><p>I now have a completely static site in the <code>html</code> directory of my repo.</p>
<p>To get those files deployed, I made some small changes in my approach to hosting on Github Pages. In the <a href="https://tome.fyi/docs/hosting/github-pages/">official Tome approach to hosting on Github</a>, these is an example shell script that can be run via a composer script that will replace your root repo with the static asset generated by Tome.&nbsp;</p>
<p>Personally, I wanted my repo to have a copy of my Drupal code rather than just the artifacts. Github Pages has an option to use Github Actions to deploy the artifacts from any artifact directory, this was perfect for my needs.</p>

  
      
  
    Image
                  
                  
                  

  


          

  
<p>You'll be prompted to create an workflow from a standard static site templatet that lives at <code>.github/workflows/static.yml</code> within your repo.</p>
<p>My static.yml looks like this.</p>
<pre><code class="language-yaml"># Simple workflow for deploying static content to GitHub Pages
name: Deploy static content to Pages
on:
  # Runs on pushes targeting the default branch
  push:
    branches: ["main"]
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write
# Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.
# However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.
concurrency:
  group: "pages"
  cancel-in-progress: false
jobs:
  # Single deploy job since we're just deploying
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Pages
        uses: actions/configure-pages@v5
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          # Upload entire repository
          path: 'html'
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4 </code></pre><p>The only bit I had to change in their example file was to change the <code>path</code> from <code>.</code> to <code>html</code> where my artifact is located.</p>
<p>After committing the workflow definition, the resulting build replaced my static Jekyll generated site with my new Tome generated site.</p>
<h2>A Couple of Gotchas and Changes</h2>
<p>Compared to authoring markdown for Jekyll, the Drupal editor experience is so much more satisfying.</p>
<p>I did experience a couple of gotchas in my first attempt at publication.</p>
<ol>
<li>Drupal CMS includes a user account menu block that displays a login link to anonymous users. The login form is useless in a static site and returned a page not found—just needed to remove the block.</li>
<li>Drupal CMS installs Klaro for cookie management which I disabled to avoid static asset errors.</li>
<li>The view created for my blog archive had AJAX enabled by default. That needed to be turned off to properly render the paginated results as static HTML.</li>
</ol>
<p>I also added a little to my default installation in addition to Tome.&nbsp;</p>
<ul>
<li>I realized that I forgot to change to authored by user to a new "joshuami" account rather than "admin", so I installed Views Bulk Edit and updated all the posts in one edit.</li>
<li>I wanted to add license information to the footer, so I installed Block Content (from core) and placed a content block in the footer.</li>
<li>As mostly a technology blog, I wanted to format my code snippets a bit so I added Highlight.js Input Filter.</li>
<li>From Drupal CMS, I installed both the SEO Tools and Accessibility Tools recipes from the project browser.</li>
<li>I didn't want the "Learn more" link on every blog post for accessibility reasons, so I removed that field from the teaser display.</li>
<li>I noticed that the teasers were kinda blah, so I enabled a Card display mode and used the <code>drupal_cms_olivero</code> template for <code>node--card.html.twig</code>, which is now included in the latest release of Drupal CMS.</li>
</ul>
<p>So far, those are my only additions, but there will be more to come.</p>
<h2>Some Drawbacks</h2>
<p>With any technology choice there will be some tradeoffs.</p>
<p>I was surprised to see that my new site does not score as well on Lighthouse.</p>


  
      
  
    Image
                  
                  
                  

  


          

  

Before the migration, I had a site that had a perfect Lighthouse score—complete with confetti!


  
      
  
    Image
                  
                  
                  

  


          

  
<p>I have not yet had a chance to debug the render blocking CSS and unused javascript that reduces the performance score. I was surprised to see that the Olivero theme would result in less than perfect accessibility. It is specifically dinged for links that rely on color to be distinguishable—they need some underlines on hover or other decoration to meet the goal.</p>
<p>While I appreciate all the amazing work to get Olivero into Drupal core, it is not my favorite theme—even for a simple blog. I'll be figuring out my theming approach in a follow up. I've considered trying TailwindCSS or similar for the experience.</p>
<p>I'm also thinking that I may need a more traditional host to store backups of the database. While a static site is great for security, it is a trade off for disaster recovery when the content is stored in an ephemeral container in my local development environment. This wasn't a concern with Jekyll as the data was all stored in markdown and committed to git. I'll have to give that a bit more thought before I generate to many more posts.</p>

      
    
  

    
  
]]></description>
  <pubDate>Wed, 18 Dec 2024 19:01:04 +0000</pubDate>
    <dc:creator>joshuami</dc:creator>
    <guid isPermaLink="false">137 at https://joshuami.com</guid>
    </item>

  </channel>
</rss>
